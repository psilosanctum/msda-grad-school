<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Collin Real (yhi267)">

<title>Midterm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Real_Collin_Midterm_files/libs/clipboard/clipboard.min.js"></script>
<script src="Real_Collin_Midterm_files/libs/quarto-html/quarto.js"></script>
<script src="Real_Collin_Midterm_files/libs/quarto-html/popper.min.js"></script>
<script src="Real_Collin_Midterm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Real_Collin_Midterm_files/libs/quarto-html/anchor.min.js"></script>
<link href="Real_Collin_Midterm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Real_Collin_Midterm_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Real_Collin_Midterm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Real_Collin_Midterm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Real_Collin_Midterm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Midterm</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Collin Real (yhi267) </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="section-i---true-t-or-false-f-20-points" class="level2">
<h2 class="anchored" data-anchor-id="section-i---true-t-or-false-f-20-points">Section I - True (T) or False (F) (20 Points)</h2>
<ol type="1">
<li><strong>False:</strong> Principal Component Regression is unsupervised learning.</li>
<li><strong>False:</strong> Collinearity increases the standard errors associated with the coefficients, causing them to worsen.</li>
<li><strong>False:</strong> R-squared of 0 means the model explains none of the variation in response Y, not -1.</li>
<li><strong>False:</strong> If the number of predictors is &gt; the number of observations, there is no longer a unique least squares coefficient estimate.</li>
<li><strong>True</strong></li>
<li><strong>True</strong></li>
<li><strong>True</strong></li>
<li><strong>True</strong></li>
<li><strong>False:</strong> OLS cannot be used.</li>
<li><strong>False:</strong> Last name is Wang, first name is Min.</li>
</ol>
</section>
<section id="section-ii---free-response-questions-25-points" class="level2">
<h2 class="anchored" data-anchor-id="section-ii---free-response-questions-25-points">Section II - Free Response Questions (25 Points)</h2>
<section id="problem-1-total-15-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-1-total-15-points">Problem 1 (Total: 15 Points)</h3>
<section id="explain-whether-each-scenario-is-a-classification-or-regression-problem-and-indicate-whether-we-are-most-interested-in-inference-or-prediction.-finally-provide-n-and-p." class="level4">
<h4 class="anchored" data-anchor-id="explain-whether-each-scenario-is-a-classification-or-regression-problem-and-indicate-whether-we-are-most-interested-in-inference-or-prediction.-finally-provide-n-and-p.">Explain whether each scenario is a classification or regression problem, and indicate whether we are most interested in inference or prediction. Finally, provide n and p.</h4>
</section>
<section id="a-we-collect-a-set-of-data-on-the-top-500-firms-in-the-us.-for-each-firm-we-record-profit-number-of-employees-industry-and-the-ceo-salary.-we-are-interested-in-understanding-which-factors-affect-ceo-salary.-5-points" class="level4">
<h4 class="anchored" data-anchor-id="a-we-collect-a-set-of-data-on-the-top-500-firms-in-the-us.-for-each-firm-we-record-profit-number-of-employees-industry-and-the-ceo-salary.-we-are-interested-in-understanding-which-factors-affect-ceo-salary.-5-points">1a) We collect a set of data on the top 500 firms in the US. For each firm we record profit, number of employees, industry, and the CEO salary. We are interested in understanding which factors affect CEO salary. (5 Points)</h4>
<p>Since CEO salary is a continuous variable, this is a <strong>regression</strong> problem. The focus is on <strong>inference</strong> because we want to understand the relationship between CEO salary and the other variables. The number of observations (<strong>n</strong>) is 500 (i.e., the top 500 firms) and the number of features (<strong>p</strong>) is 3 (i.e., profit, number of employees, and industry).</p>
</section>
<section id="b-we-are-considering-launching-a-new-product-and-wish-to-know-whether-it-will-be-a-success-or-a-failure.-we-collect-data-on-20-similar-products-that-were-previously-launched.-for-each-product-we-have-recorded-whether-it-was-a-success-or-failure-price-charged-for-the-product-marketing-budget-competition-price-and-ten-other-variables.-5-points" class="level4">
<h4 class="anchored" data-anchor-id="b-we-are-considering-launching-a-new-product-and-wish-to-know-whether-it-will-be-a-success-or-a-failure.-we-collect-data-on-20-similar-products-that-were-previously-launched.-for-each-product-we-have-recorded-whether-it-was-a-success-or-failure-price-charged-for-the-product-marketing-budget-competition-price-and-ten-other-variables.-5-points">1b) We are considering launching a new product and wish to know whether it will be a success or a failure. We collect data on 20 similar products that were previously launched. For each product we have recorded whether it was a success or failure, price charged for the product, marketing budget, competition price, and ten other variables. (5 Points)</h4>
<p>Since the outcome is a categorical variable, this is a <strong>classification</strong> problem. The focus is on <strong>prediction</strong> because we want to predict the outcome of a new product launch. The number of observations (<strong>n</strong>) is 20 (i.e., 20 products) and the number of features (<strong>p</strong>) is 13.</p>
</section>
<section id="c-we-are-interested-in-predicting-the-change-in-the-usdeuro-exchange-rate-in-relation-to-the-weekly-changes-in-the-world-stock-markets.-hence-we-collect-weekly-data-for-all-of-2012.-for-each-week-we-record-the-change-in-the-usdeuro-the-change-in-the-us-market-the-change-in-the-british-market-and-the-change-in-the-german-market.-5-points" class="level4">
<h4 class="anchored" data-anchor-id="c-we-are-interested-in-predicting-the-change-in-the-usdeuro-exchange-rate-in-relation-to-the-weekly-changes-in-the-world-stock-markets.-hence-we-collect-weekly-data-for-all-of-2012.-for-each-week-we-record-the-change-in-the-usdeuro-the-change-in-the-us-market-the-change-in-the-british-market-and-the-change-in-the-german-market.-5-points">1c) We are interested in predicting the % change in the USD/Euro exchange rate in relation to the weekly changes in the world stock markets. Hence we collect weekly data for all of 2012. For each week we record the % change in the USD/Euro, the % change in the US market, the % change in the British market, and the % change in the German market. (5 Points)</h4>
<p>Since the percentage change in the USD/Euro exchange rate is a continuous variable, this is a <strong>regression</strong> problem. The focus is on <strong>prediction</strong> because we want to predict future changes in the rate. The number of observations (<strong>n</strong>) is 52 (i.e., 52 weeks of data) and the number of features (<strong>p</strong>) is 3.</p>
</section>
</section>
<section id="problem-2-total-10-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-2-total-10-points">Problem 2 (Total: 10 Points)</h3>
<section id="in-this-class-we-discussed-the-bias-variance-trade-off.-answer-the-following-questions." class="level4">
<h4 class="anchored" data-anchor-id="in-this-class-we-discussed-the-bias-variance-trade-off.-answer-the-following-questions.">In this class, we discussed the bias-variance trade-off. Answer the following questions.</h4>
</section>
<section id="a-provide-a-sketch-of-typical-squared-bias-variance-training-error-test-error-curves-on-a-single-plot-as-we-go-from-less-flexible-statistical-learning-methods-towards-more-flexible-approaches.-the-x-axis-should-represent-the-amount-of-flexibility-in-the-method-and-the-y-axis-should-represent-the-values-for-each-curve.-there-should-be-four-curves.-make-sure-to-label-each-one." class="level4">
<h4 class="anchored" data-anchor-id="a-provide-a-sketch-of-typical-squared-bias-variance-training-error-test-error-curves-on-a-single-plot-as-we-go-from-less-flexible-statistical-learning-methods-towards-more-flexible-approaches.-the-x-axis-should-represent-the-amount-of-flexibility-in-the-method-and-the-y-axis-should-represent-the-values-for-each-curve.-there-should-be-four-curves.-make-sure-to-label-each-one.">2a) Provide a sketch of typical (squared) bias, variance, training error, test error curves, on a single plot, as we go from less flexible statistical learning methods towards more flexible approaches. The x-axis should represent the amount of flexibility in the method, and the y-axis should represent the values for each curve. There should be four curves. Make sure to label each one.</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sketch_2a.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Statistical learning methods flexibility sketch</figcaption>
</figure>
</div>
</section>
<section id="b-briefly-explain-why-each-of-the-four-curves-has-the-shape-displayed-in-part-a." class="level4">
<h4 class="anchored" data-anchor-id="b-briefly-explain-why-each-of-the-four-curves-has-the-shape-displayed-in-part-a.">2b) Briefly explain why each of the four curves has the shape displayed in part (a).</h4>
</section>
</section>
</section>
<section id="section-iii---coding-questions-55-points" class="level2">
<h2 class="anchored" data-anchor-id="section-iii---coding-questions-55-points">Section III - Coding Questions (55 Points)</h2>
<section id="problem-3-total-18-points---3-points-each" class="level3">
<h3 class="anchored" data-anchor-id="problem-3-total-18-points---3-points-each">Problem 3 (Total: 18 Points - 3 points each)</h3>
<section id="this-exercise-involves-the-auto-data-set-studied-in-the-lab.-make-sure-that-the-missing-values-have-been-removed-from-the-data.-we-may-start-r-and-use-these-commands-to-load-the-data" class="level4">
<h4 class="anchored" data-anchor-id="this-exercise-involves-the-auto-data-set-studied-in-the-lab.-make-sure-that-the-missing-values-have-been-removed-from-the-data.-we-may-start-r-and-use-these-commands-to-load-the-data">This exercise involves the Auto data set studied in the lab. Make sure that the missing values have been removed from the data. We may start R and use these commands to load the data:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlist)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">'Auto'</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   392 obs. of  9 variables:
 $ mpg         : num  18 15 18 16 17 15 14 14 14 15 ...
 $ cylinders   : num  8 8 8 8 8 8 8 8 8 8 ...
 $ displacement: num  307 350 318 304 302 429 454 440 455 390 ...
 $ horsepower  : num  130 165 150 150 140 198 220 215 225 190 ...
 $ weight      : num  3504 3693 3436 3433 3449 ...
 $ acceleration: num  12 11.5 11 12 10.5 10 9 8.5 10 8.5 ...
 $ year        : num  70 70 70 70 70 70 70 70 70 70 ...
 $ origin      : num  1 1 1 1 1 1 1 1 1 1 ...
 $ name        : Factor w/ 304 levels "amc ambassador brougham",..: 49 36 231 14 161 141 54 223 241 2 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert numeric to factor: cylinders &amp; origin</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Auto<span class="sc">$</span>cylinders <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Auto<span class="sc">$</span>cylinders)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Auto<span class="sc">$</span>origin <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Auto<span class="sc">$</span>origin)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify updated data types</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   392 obs. of  9 variables:
 $ mpg         : num  18 15 18 16 17 15 14 14 14 15 ...
 $ cylinders   : Factor w/ 5 levels "3","4","5","6",..: 5 5 5 5 5 5 5 5 5 5 ...
 $ displacement: num  307 350 318 304 302 429 454 440 455 390 ...
 $ horsepower  : num  130 165 150 150 140 198 220 215 225 190 ...
 $ weight      : num  3504 3693 3436 3433 3449 ...
 $ acceleration: num  12 11.5 11 12 10.5 10 9 8.5 10 8.5 ...
 $ year        : num  70 70 70 70 70 70 70 70 70 70 ...
 $ origin      : Factor w/ 3 levels "1","2","3": 1 1 1 1 1 1 1 1 1 1 ...
 $ name        : Factor w/ 304 levels "amc ambassador brougham",..: 49 36 231 14 161 141 54 223 241 2 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Check for missing values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Auto_missing_values <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        Auto</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Missing values: "</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        Auto_missing_values</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Missing values: 0"</code></pre>
</div>
</div>
</section>
<section id="a-which-of-the-predictors-are-quantitative-and-which-are-qualitative" class="level4">
<h4 class="anchored" data-anchor-id="a-which-of-the-predictors-are-quantitative-and-which-are-qualitative">3a) Which of the predictors are quantitative, and which are qualitative?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>quant_preds <span class="ot">&lt;-</span> <span class="fu">colnames</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        Auto, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        is.numeric</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>qual_preds <span class="ot">&lt;-</span> <span class="fu">colnames</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        Auto, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        is.factor</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Quantitative predictor(s): "</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        quant_preds</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor(s): 
mpg
displacement
horsepower
weight
acceleration
year</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Qualititative predictor(s): '</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        qual_preds</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Qualititative predictor(s): 
cylinders
origin
name</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create key values for dictionary for pretty printing </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>quant_preds_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select_if</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            Auto, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            is.numeric</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>quant_preds_keys <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>colon <span class="ot">&lt;-</span> <span class="st">": "</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pred <span class="cf">in</span> quant_preds_list) {</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    new_pred <span class="ot">=</span> <span class="fu">paste</span>(</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        pred, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        colon, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    quant_preds_keys <span class="ot">=</span> <span class="fu">append</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        new_pred</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(quant_preds) <span class="ot">&lt;-</span> <span class="fu">cat</span>(quant_preds_keys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mpg:  displacement:  horsepower:  weight:  acceleration:  year: </code></pre>
</div>
</div>
</section>
<section id="b-what-is-the-range-of-each-quantitative-predictor-you-can-answer-this-using-the-range-function." class="level4">
<h4 class="anchored" data-anchor-id="b-what-is-the-range-of-each-quantitative-predictor-you-can-answer-this-using-the-range-function.">3b) What is the range of each quantitative predictor? You can answer this using the range() function.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>quant_preds_range <span class="ot">&lt;-</span> <span class="fu">sapply</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    Auto[, quant_preds], </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    range</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quantitative predictor ranges:'</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        quant_preds_range[<span class="dv">1</span>,], </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">" - "</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        quant_preds_range[<span class="dv">2</span>,]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor ranges:
mpg: 9 - 46.6
displacement: 68 - 455
horsepower: 46 - 230
weight: 1613 - 5140
acceleration: 8 - 24.8
year: 70 - 82</code></pre>
</div>
</div>
</section>
<section id="c-what-is-the-mean-and-standard-deviation-of-each-quantitative-predictor" class="level4">
<h4 class="anchored" data-anchor-id="c-what-is-the-mean-and-standard-deviation-of-each-quantitative-predictor">3c) What is the mean and standard deviation of each quantitative predictor?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>quant_preds_mean <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        Auto[, quant_preds], </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        mean</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>quant_preds_sd <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        Auto[, quant_preds], </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        sd</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quantitative predictor means:'</span>, </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys, </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        quant_preds_mean</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor means:
mpg: 23.45
displacement: 194.41
horsepower: 104.47
weight: 2977.58
acceleration: 15.54
year: 75.98</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quantitative predictor standard deviations:'</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        quant_preds_sd</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor standard deviations:
mpg: 7.81
displacement: 104.64
horsepower: 38.49
weight: 849.4
acceleration: 2.76
year: 3.68</code></pre>
</div>
</div>
</section>
<section id="d-now-remove-the-20th-through-80th-observations.-what-is-the-range-mean-and-standard-deviation-of-each-predictor-in-the-subset-of-the-data-that-remains" class="level4">
<h4 class="anchored" data-anchor-id="d-now-remove-the-20th-through-80th-observations.-what-is-the-range-mean-and-standard-deviation-of-each-predictor-in-the-subset-of-the-data-that-remains">3d) Now remove the 20th through 80th observations. What is the range, mean, and standard deviation of each predictor in the subset of the data that remains?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>subset_Auto <span class="ot">&lt;-</span> Auto[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">80</span>), ]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>range_Auto_subset <span class="ot">&lt;-</span> <span class="fu">sapply</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    subset_Auto[, quant_preds], </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    range</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>mean_Auto_subset <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    subset_Auto[, quant_preds], </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    mean</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>sd_Auto_subset <span class="ot">&lt;-</span> <span class="fu">round</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    subset_Auto[, quant_preds], </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    sd</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quantitative predictor subset ranges:'</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        range_Auto_subset[<span class="dv">1</span>,], </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">" - "</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        range_Auto_subset[<span class="dv">2</span>,]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor subset ranges:
mpg: 11 - 46.6
displacement: 68 - 455
horsepower: 46 - 230
weight: 1649 - 4997
acceleration: 8 - 24.8
year: 70 - 82</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quantitative predictor subset means:'</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        mean_Auto_subset</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor subset means:
mpg: 24.22
displacement: 189.44
horsepower: 101.86
weight: 2935.02
acceleration: 15.61
year: 76.85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quantitative predictor subset standard deviations:'</span>, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        quant_preds_keys, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        sd_Auto_subset</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantitative predictor subset standard deviations:
mpg: 7.82
displacement: 101.76
horsepower: 36.6
weight: 805.48
acceleration: 2.76
year: 3.32</code></pre>
</div>
</div>
</section>
<section id="e-using-the-full-data-set-investigate-the-predictors-graphically-using-scatterplots-or-other-tools-of-your-choice.-create-some-plots-highlighting-the-relationships-among-the-predictors.-comment-on-your-findings." class="level4">
<h4 class="anchored" data-anchor-id="e-using-the-full-data-set-investigate-the-predictors-graphically-using-scatterplots-or-other-tools-of-your-choice.-create-some-plots-highlighting-the-relationships-among-the-predictors.-comment-on-your-findings.">3e) Using the full data set, investigate the predictors graphically, using scatterplots or other tools of your choice. Create some plots highlighting the relationships among the predictors. Comment on your findings.</h4>
</section>
<section id="scatterplot-correlation" class="level4">
<h4 class="anchored" data-anchor-id="scatterplot-correlation">Scatterplot Correlation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">~</span>mpg<span class="sc">+</span>displacement<span class="sc">+</span>horsepower<span class="sc">+</span>weight<span class="sc">+</span>acceleration<span class="sc">+</span>year,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>Auto,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">"Investigate Potential Variable Correlation"</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">'blue'</span>, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg=</span><span class="st">'lightblue'</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">21</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="heatmap-correlation" class="level4">
<h4 class="anchored" data-anchor-id="heatmap-correlation">Heatmap Correlation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Auto <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"number"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Correlation Heatmap of Numerical Predictors'</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">'upper'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="box-plots" class="level4">
<h4 class="anchored" data-anchor-id="box-plots">Box Plots</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Auto <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">'black'</span>, <span class="at">fill=</span><span class="st">'steelblue'</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>((<span class="st">"Numerical Predictors - Box Plots"</span>)) <span class="sc">+</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="histogram-plots" class="level4">
<h4 class="anchored" data-anchor-id="histogram-plots">Histogram Plots</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Auto <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">'black'</span>, <span class="at">fill=</span><span class="st">'steelblue'</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>((<span class="st">"Numerical Predictors - Histograms"</span>)) <span class="sc">+</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Comments on predictor relationships:</strong> Based on our scatterplots and heatmap, mpg has a strong negative relationship with displacement, horsepower, and weight as well as a moderate positive relationship with year. Horsepower has a moderately strong negative relationship with acceleration, and a strong positive relationship with weight. Displacement has a strong positive relationship with horsepower and weight, and a moderate negative relationship with acceleration.</p>
</section>
<section id="f-suppose-that-we-wish-to-predict-gas-mileage-mpg-on-the-basis-of-the-other-variables.-do-your-plots-suggest-that-any-of-the-other-variables-might-be-useful-in-predicting-mpg-justify-your-answer." class="level4">
<h4 class="anchored" data-anchor-id="f-suppose-that-we-wish-to-predict-gas-mileage-mpg-on-the-basis-of-the-other-variables.-do-your-plots-suggest-that-any-of-the-other-variables-might-be-useful-in-predicting-mpg-justify-your-answer.">3f) Suppose that we wish to predict gas mileage (mpg) on the basis of the other variables. Do your plots suggest that any of the other variables might be useful in predicting mpg? Justify your answer.</h4>
<p>The correlation coefficients for variables displacement, horsepower, and weight are -0.81, -0.78, and -0.83, respectively. Since the magnitudes of these coefficients fall between the range -0.9 and -0.7, these variables have a strong negative correlation with mpg: - As engine displacement (inches) increases, the car gets less mpg. - As horsepower increases, mpg decreases. - As vehicle weight increases (lbs), mpg decreases. Addtionally, mpg has a moderate positive correlation (coeff = 0.58) with the model year of the vehicle, indicating that newer cars get better gas mileage. Considering our observations, these four variables might serve as useful predictors for building a model to predict mpg.</p>
</section>
</section>
<section id="problem-4-total-15-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-4-total-15-points">Problem 4 (Total: 15 Points)</h3>
<section id="we-will-predict-the-number-of-applications-received-using-the-other-variables-in-the-college-data-set-available-in-the-r-package-islr-which-can-be-accessed-as-follows." class="level4">
<h4 class="anchored" data-anchor-id="we-will-predict-the-number-of-applications-received-using-the-other-variables-in-the-college-data-set-available-in-the-r-package-islr-which-can-be-accessed-as-follows.">We will predict the number of applications received using the other variables in the College data set available in the R package ISLR, which can be accessed as follows.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(earth)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(College)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#data basic information</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(College)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             Private Apps Accept Enroll Top10perc Top25perc
Abilene Christian University     Yes 1660   1232    721        23        52
Adelphi University               Yes 2186   1924    512        16        29
Adrian College                   Yes 1428   1097    336        22        50
Agnes Scott College              Yes  417    349    137        60        89
Alaska Pacific University        Yes  193    146     55        16        44
Albertson College                Yes  587    479    158        38        62
                             F.Undergrad P.Undergrad Outstate Room.Board Books
Abilene Christian University        2885         537     7440       3300   450
Adelphi University                  2683        1227    12280       6450   750
Adrian College                      1036          99    11250       3750   400
Agnes Scott College                  510          63    12960       5450   450
Alaska Pacific University            249         869     7560       4120   800
Albertson College                    678          41    13500       3335   500
                             Personal PhD Terminal S.F.Ratio perc.alumni Expend
Abilene Christian University     2200  70       78      18.1          12   7041
Adelphi University               1500  29       30      12.2          16  10527
Adrian College                   1165  53       66      12.9          30   8735
Agnes Scott College               875  92       97       7.7          37  19016
Alaska Pacific University        1500  76       72      11.9           2  10922
Albertson College                 675  67       73       9.4          11   9727
                             Grad.Rate
Abilene Christian University        60
Adelphi University                  56
Adrian College                      54
Agnes Scott College                 59
Alaska Pacific University           15
Albertson College                   55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(College)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 777  18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The column Apps is the response variable, and others may be treated as predictors.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#For instance, for linear regression model in R, you may use</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Apps<span class="sc">~</span>.,<span class="at">data=</span>College)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Apps ~ ., data = College)

Coefficients:
(Intercept)   PrivateYes       Accept       Enroll    Top10perc    Top25perc  
 -445.08413   -494.14897      1.58581     -0.88069     49.92628    -14.23448  
F.Undergrad  P.Undergrad     Outstate   Room.Board        Books     Personal  
    0.05739      0.04445     -0.08587      0.15103      0.02090      0.03110  
        PhD     Terminal    S.F.Ratio  perc.alumni       Expend    Grad.Rate  
   -8.67850     -3.33066     15.38961      0.17867      0.07790      8.66763  </code></pre>
</div>
</div>
</section>
<section id="a-appropriately-split-the-data-set-into-a-training-set-80-and-a-test-set-20.-3-points" class="level4">
<h4 class="anchored" data-anchor-id="a-appropriately-split-the-data-set-into-a-training-set-80-and-a-test-set-20.-3-points">4a) Appropriately split the data set into a training set (80%) and a test set (20%). [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(College<span class="sc">$</span>Apps, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> College[train_index, ]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> College[<span class="sc">-</span>train_index, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b-fit-a-support-vector-machine-svm-model-with-the-radial-basis-function-function-model-using-least-squares-on-the-training-set.-clearly-report-the-test-error-obtained.-3-points" class="level4">
<h4 class="anchored" data-anchor-id="b-fit-a-support-vector-machine-svm-model-with-the-radial-basis-function-function-model-using-least-squares-on-the-training-set.-clearly-report-the-test-error-obtained.-3-points">4b) Fit a support vector machine (SVM) model with the radial basis function function model using least squares on the training set. Clearly report the test error obtained. [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit SVM-RBF model</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>svm_mod <span class="ot">&lt;-</span> <span class="fu">svm</span>(Apps <span class="sc">~</span> ., train_data, <span class="at">kernel =</span> <span class="st">"radial"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict test data</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>svm_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_mod, test_data)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcuate MSE (Mean Squared Error)</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>svm_mse <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>((svm_preds <span class="sc">-</span> test_data<span class="sc">$</span>Apps)<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SVM MSE:"</span>, <span class="fu">paste0</span>(svm_mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SVM MSE: 622415.53</code></pre>
</div>
</div>
</section>
<section id="c-fit-a-neural-network-model-on-the-training-set-by-creating-an-appropriate-grid-for-tuning-parameters.-clearly-report-the-test-error-obtained.-3-points" class="level4">
<h4 class="anchored" data-anchor-id="c-fit-a-neural-network-model-on-the-training-set-by-creating-an-appropriate-grid-for-tuning-parameters.-clearly-report-the-test-error-obtained.-3-points">4c) Fit a neural network model on the training set by creating an appropriate grid for tuning parameters. Clearly report the test error obtained. [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Neural network tuning grid</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>grid_neural_network <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>), <span class="at">decay =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit neural network model</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>model_neural_network <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  Apps <span class="sc">~</span> ., </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"nnet"</span>, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> grid_neural_network, </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> <span class="cn">FALSE</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict test data</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>preds_neural_network <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_neural_network, test_data)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the MSE</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>neural_network_mse <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>((preds_neural_network <span class="sc">-</span> test_data<span class="sc">$</span>Apps)<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Neural Network MSE:"</span>, <span class="fu">paste0</span>(neural_network_mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neural Network MSE: 14683008.9</code></pre>
</div>
</div>
</section>
<section id="d-fit-a-multivariate-adaptive-regression-splines-mars-model-on-the-training-set-with-tuning-parameters-chosen-by-cross-validation.-clearly-report-the-test-error-obtained-along-with-the-importance-of-each-predictor.-estimates.-3-points" class="level4">
<h4 class="anchored" data-anchor-id="d-fit-a-multivariate-adaptive-regression-splines-mars-model-on-the-training-set-with-tuning-parameters-chosen-by-cross-validation.-clearly-report-the-test-error-obtained-along-with-the-importance-of-each-predictor.-estimates.-3-points">4d) Fit a Multivariate Adaptive Regression Splines (MARS) model on the training set with tuning parameters chosen by cross-validation. Clearly report the test error obtained, along with the importance of each predictor. estimates. [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit MARS model with cross-validation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>mars_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  Apps <span class="sc">~</span> ., </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"earth"</span>, </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">5</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict test data</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>mars_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(mars_mod, test_data)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the MSE</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>mars_mse <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>((mars_preds <span class="sc">-</span> test_data<span class="sc">$</span>Apps)<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'MARS MSE:'</span>, <span class="fu">paste0</span>(mars_mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MARS MSE: 822261.73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable importance</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>variable_importance <span class="ot">&lt;-</span> <span class="fu">varImp</span>(mars_mod)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>variable_importance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>earth variable importance

            Overall
Accept      100.000
Top10perc    16.090
Enroll        3.688
F.Undergrad   0.000</code></pre>
</div>
</div>
</section>
<section id="e-comment-on-the-results-obtained.-is-there-much-difference-among-the-test-errors-resulting-from-these-three-nonparametric-approaches-3-points" class="level4">
<h4 class="anchored" data-anchor-id="e-comment-on-the-results-obtained.-is-there-much-difference-among-the-test-errors-resulting-from-these-three-nonparametric-approaches-3-points">4e) Comment on the results obtained. Is there much difference among the test errors resulting from these three nonparametric approaches? [3 points]</h4>
</section>
<section id="svm-results" class="level4">
<h4 class="anchored" data-anchor-id="svm-results">SVM Results</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>svm_mod</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = Apps ~ ., data = train_data, kernel = "radial")


Parameters:
   SVM-Type:  eps-regression 
 SVM-Kernel:  radial 
       cost:  1 
      gamma:  0.05555556 
    epsilon:  0.1 


Number of Support Vectors:  278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SVM MSE: "</span>, svm_mse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SVM MSE:  622415.5</code></pre>
</div>
</div>
</section>
<section id="neural-network-results" class="level4">
<h4 class="anchored" data-anchor-id="neural-network-results">Neural Network Results</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>model_neural_network</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neural Network 

624 samples
 17 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 499, 500, 497, 500, 500 
Resampling results across tuning parameters:

  size  decay  RMSE      Rsquared      MAE     
   5    0.1    5069.826  0.0005407588  3091.989
   5    0.5    5069.826           NaN  3091.989
  10    0.1    5069.826  0.0706531705  3091.989
  10    0.5    5069.826  0.0893022018  3091.989

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were size = 5 and decay = 0.5.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Neural Network MSE: "</span>, neural_network_mse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neural Network MSE:  14683009</code></pre>
</div>
</div>
</section>
<section id="mars-results" class="level4">
<h4 class="anchored" data-anchor-id="mars-results">MARS Results</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mars_mod</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multivariate Adaptive Regression Spline 

624 samples
 17 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 499, 500, 497, 500, 500 
Resampling results across tuning parameters:

  nprune  RMSE      Rsquared   MAE     
   2      1594.315  0.8500763  699.0368
   4      1270.057  0.9178074  548.5028
   6      1251.483  0.9218557  557.1920
   8      1286.650  0.9170281  597.1205
  10      1311.021  0.9134643  608.1759

Tuning parameter 'degree' was held constant at a value of 1
RMSE was used to select the optimal model using the smallest value.
The final values used for the model were nprune = 6 and degree = 1.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MARS MSE: "</span>, mars_mse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MARS MSE:  822261.7</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> There is much difference among the test errors resulting from these three nonparametric approaches. The neural network approach calculated the largest test error. Additionally, it did not calculate decent R-squared values. The MARS model had the second highest test error, but the model produced R-squared values greater than 85%, indicating that it explains the variance of the data well. The support vector machine with the radial basis function calculated the lowest test error.</p>
</section>
</section>
<section id="problem-5-total-22-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-5-total-22-points">Problem 5 (Total: 22 Points)</h3>
<section id="a-chemical-manufacturing-process-for-a-pharmaceutical-product-was-discussed-in-sect.-1.4-of-the-textbook.-in-this-problem-the-objective-is-to-understand-the-relationship-between-biological-measurements-of-the-raw-materials-predictors-measurements-of-the-manufacturing-process-predictors-and-the-response-of-product-yield.-biological-predictors-cannot-be-changed-but-can-be-used-to-assess-the-quality-of-the-raw-material-before-processing.-on-the-other-hand-manufacturing-process-predictors-can-be-changed-in-the-manufacturing-process.-improving-product-yield-by-1-will-boost-revenue-by-approximately-one-hundred-thousand-dollars-per-batch.-we-may-start-r-and-use-these-commands-to-load-the-data" class="level4">
<h4 class="anchored" data-anchor-id="a-chemical-manufacturing-process-for-a-pharmaceutical-product-was-discussed-in-sect.-1.4-of-the-textbook.-in-this-problem-the-objective-is-to-understand-the-relationship-between-biological-measurements-of-the-raw-materials-predictors-measurements-of-the-manufacturing-process-predictors-and-the-response-of-product-yield.-biological-predictors-cannot-be-changed-but-can-be-used-to-assess-the-quality-of-the-raw-material-before-processing.-on-the-other-hand-manufacturing-process-predictors-can-be-changed-in-the-manufacturing-process.-improving-product-yield-by-1-will-boost-revenue-by-approximately-one-hundred-thousand-dollars-per-batch.-we-may-start-r-and-use-these-commands-to-load-the-data">A chemical manufacturing process for a pharmaceutical product was discussed in Sect. 1.4 of the textbook. In this problem, the objective is to understand the relationship between biological measurements of the raw materials (predictors), measurements of the manufacturing process (predictors), and the response of product yield. Biological predictors cannot be changed but can be used to assess the quality of the raw material before processing. On the other hand, manufacturing process predictors can be changed in the manufacturing process. Improving product yield by 1% will boost revenue by approximately one hundred thousand dollars per batch. We may start R and use these commands to load the data:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AppliedPredictiveModeling)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ChemicalManufacturingProcess"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-matrix-processpredictors-contains-the-57-predictors-12-describing-the-input-biological-material-and-45-describing-the-process-predictors-for-the-176-manufacturing-runs.-yield-contains-the-percent-yield-for-each-run." class="level4">
<h4 class="anchored" data-anchor-id="the-matrix-processpredictors-contains-the-57-predictors-12-describing-the-input-biological-material-and-45-describing-the-process-predictors-for-the-176-manufacturing-runs.-yield-contains-the-percent-yield-for-each-run.">The matrix processPredictors contains the 57 predictors (12 describing the input biological material and 45 describing the process predictors) for the 176 manufacturing runs. yield contains the percent yield for each run.</h4>
</section>
<section id="a-a-small-percentage-of-cells-in-the-predictor-set-contain-missing-values.-use-an-appropriate-imputation-function-to-fill-in-these-missing-values.-3-points" class="level4">
<h4 class="anchored" data-anchor-id="a-a-small-percentage-of-cells-in-the-predictor-set-contain-missing-values.-use-an-appropriate-imputation-function-to-fill-in-these-missing-values.-3-points">5a) A small percentage of cells in the predictor set contain missing values. Use an appropriate imputation function to fill in these missing values. [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify missing values</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>missing_vals <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(ChemicalManufacturingProcess))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Pre-imputation missing values: "</span>, missing_vals))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pre-imputation missing values: 106"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing values with k-NN</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>pre_process <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(ChemicalManufacturingProcess, <span class="fu">c</span>(<span class="st">"knnImpute"</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">predict</span>(pre_process, ChemicalManufacturingProcess)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check successful imputation (i.e., 0 missing values)</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>impute_miss <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(pre_process))</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Post-imputation missing values: "</span>, impute_miss))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Post-imputation missing values: 0"</code></pre>
</div>
</div>
</section>
<section id="b-split-the-data-into-a-training-and-a-test-set-pre-process-the-data-and-build-at-least-four-different-models-from-chapter-6.-for-those-models-with-tuning-parameters-e.g.-enet-what-are-the-optimal-values-of-the-tuning-parameters-8-points" class="level4">
<h4 class="anchored" data-anchor-id="b-split-the-data-into-a-training-and-a-test-set-pre-process-the-data-and-build-at-least-four-different-models-from-chapter-6.-for-those-models-with-tuning-parameters-e.g.-enet-what-are-the-optimal-values-of-the-tuning-parameters-8-points">5b) Split the data into a training and a test set, pre-process the data, and build at least four different models from Chapter 6. For those models with tuning parameters (e.g., ENET), what are the optimal values of the tuning parameter(s)? [8 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variables to separate predictors and response</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>proc_preds <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> df[, <span class="dv">1</span>]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(resp, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> proc_preds[train_index, ]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>train_resp <span class="ot">&lt;-</span> resp[train_index]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> proc_preds[<span class="sc">-</span>train_index, ]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>test_resp <span class="ot">&lt;-</span> resp[<span class="sc">-</span>train_index]</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Data normalization - center and scale</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>pre_process_range <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(train_data, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>train_transformed <span class="ot">&lt;-</span> <span class="fu">predict</span>(pre_process_range, train_data)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>test_transformed <span class="ot">&lt;-</span> <span class="fu">predict</span>(pre_process_range, test_data)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list for model training</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ENET =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), </span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ridge =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), </span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">PCR =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">PLS =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>) </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Tuning grids</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>tuning_grids <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">ENET =</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">10</span>), <span class="at">lambda =</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="at">length =</span> <span class="dv">100</span>)),</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ridge =</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="at">length =</span> <span class="dv">100</span>)),</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">PLS =</span> <span class="fu">expand.grid</span>(<span class="at">ncomp =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the four models</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>enet_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(train_transformed, train_resp, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> models<span class="sc">$</span>ENET, <span class="at">tuneGrid =</span> tuning_grids<span class="sc">$</span>ENET)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>ridge_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(train_transformed, train_resp, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> models<span class="sc">$</span>Ridge, <span class="at">tuneGrid =</span> tuning_grids<span class="sc">$</span>Ridge)</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>pls_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(train_transformed, train_resp, <span class="at">method =</span> <span class="st">"pls"</span>, <span class="at">trControl =</span> models<span class="sc">$</span>PLS, <span class="at">tuneGrid =</span> tuning_grids<span class="sc">$</span>PLS)</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>pcr_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(train_transformed, train_resp, <span class="at">method =</span> <span class="st">"pcr"</span>, <span class="at">trControl =</span> models<span class="sc">$</span>PCR, <span class="at">tuneGrid =</span> tuning_grids<span class="sc">$</span>PLS)</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal tuning parameters</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>enet_mod<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    alpha    lambda
940     1 0.1417474</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ridge_mod<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   alpha   lambda
59     0 4.862602</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>pls_mod<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ncomp
3     3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>pcr_mod<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ncomp
10    10</code></pre>
</div>
</div>
</section>
<section id="c-which-model-has-the-best-predictive-ability-is-any-model-significantly-better-or-worse-than-the-others-you-need-to-conduct-a-hypothesis-testing-to-justify-your-choice-if-necessary.-5-points" class="level4">
<h4 class="anchored" data-anchor-id="c-which-model-has-the-best-predictive-ability-is-any-model-significantly-better-or-worse-than-the-others-you-need-to-conduct-a-hypothesis-testing-to-justify-your-choice-if-necessary.-5-points">5c) Which model has the best predictive ability? Is any model significantly better or worse than the others? You need to conduct a hypothesis testing to justify your choice if necessary. [5 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict test set</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>enet_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(enet_mod, test_transformed)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ridge_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge_mod, test_transformed)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>pls_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(pls_mod, test_transformed)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>pcr_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(pcr_mod, test_transformed)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MSE (Mean Squared Error)</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>test_err_enet <span class="ot">&lt;-</span> <span class="fu">mean</span>((enet_preds <span class="sc">-</span> test_resp)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>test_err_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>((ridge_preds <span class="sc">-</span> test_resp)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>test_err_pls <span class="ot">&lt;-</span> <span class="fu">mean</span>((pls_preds <span class="sc">-</span> test_resp)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>test_err_pcr <span class="ot">&lt;-</span> <span class="fu">mean</span>((pcr_preds <span class="sc">-</span> test_resp)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print MSE</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ENET Test Error: "</span>, test_err_enet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ENET Test Error:  0.4927384</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ridge Test Error: "</span>, test_err_ridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ridge Test Error:  0.6256541</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PLS Test Error: "</span>, test_err_pls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PLS Test Error:  0.3802276</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PCR Test Error: "</span>, test_err_pcr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PCR Test Error:  0.4212739</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residuals for each model</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>enet_res <span class="ot">&lt;-</span> <span class="fu">predict</span>(enet_mod, test_transformed) <span class="sc">-</span> test_resp</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>ridge_res <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge_mod, test_transformed) <span class="sc">-</span> test_resp</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>pls_res <span class="ot">&lt;-</span> <span class="fu">predict</span>(pls_mod, test_transformed) <span class="sc">-</span> test_resp</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>pcr_res <span class="ot">&lt;-</span> <span class="fu">predict</span>(pcr_mod, test_transformed) <span class="sc">-</span> test_resp</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired t-tests comparing ENET res with other models</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>enet_ridge_t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(enet_res, ridge_res, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>enet_pls_t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(enet_res, pls_res, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>enet_pcr_t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(enet_res, pcr_res, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-values of the t-tests</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value for ENET vs. Ridge Regression:"</span>, enet_ridge_t_test<span class="sc">$</span>p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value for ENET vs. Ridge Regression: 0.3235442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value for ENET vs. PLS:"</span>, enet_pls_t_test<span class="sc">$</span>p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value for ENET vs. PLS: 0.945268</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value for ENET vs. PCR:"</span>, enet_pcr_t_test<span class="sc">$</span>p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value for ENET vs. PCR: 0.8532876</code></pre>
</div>
</div>
</section>
<section id="d-which-predictors-are-most-important-in-the-model-you-have-trained-do-either-the-biological-or-process-predictors-dominate-the-list-3-points" class="level4">
<h4 class="anchored" data-anchor-id="d-which-predictors-are-most-important-in-the-model-you-have-trained-do-either-the-biological-or-process-predictors-dominate-the-list-3-points">5d) Which predictors are most important in the model you have trained? Do either the biological or process predictors dominate the list [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable Importance - ENET</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>variable_importance <span class="ot">&lt;-</span> <span class="fu">varImp</span>(enet_mod)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(variable_importance, <span class="at">top =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>top_preds <span class="ot">&lt;-</span> <span class="fu">rownames</span>(variable_importance<span class="sc">$</span>importance)[<span class="fu">order</span>(variable_importance<span class="sc">$</span>importance[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]]</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 10 predictors: "</span>, <span class="fu">paste0</span>(top_preds), <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 10 predictors: 
ManufacturingProcess32
ManufacturingProcess09
ManufacturingProcess13
ManufacturingProcess06
ManufacturingProcess17
ManufacturingProcess37
BiologicalMaterial01
BiologicalMaterial02
BiologicalMaterial03
BiologicalMaterial04</code></pre>
</div>
</div>
<p><strong>The top 10 predictors indicate that the majority are process rather than biological predictors.</strong></p>
</section>
<section id="e-explore-the-relationships-between-each-of-the-top-predictors-and-the-response.-how-could-this-information-be-helpful-in-improving-yield-in-future-runs-of-the-manufacturing-process-3-points" class="level4">
<h4 class="anchored" data-anchor-id="e-explore-the-relationships-between-each-of-the-top-predictors-and-the-response.-how-could-this-information-be-helpful-in-improving-yield-in-future-runs-of-the-manufacturing-process-3-points">5e) Explore the relationships between each of the top predictors and the response. How could this information be helpful in improving yield in future runs of the manufacturing process? [3 points]</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pred <span class="cf">in</span> top_preds) {</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(train_transformed[, pred], train_resp, <span class="at">main =</span> pred, <span class="at">xlab =</span> pred, <span class="at">ylab =</span> <span class="st">"Yield"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(train_resp <span class="sc">~</span> train_transformed[, pred]), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Real_Collin_Midterm_files/figure-html/unnamed-chunk-29-10.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>